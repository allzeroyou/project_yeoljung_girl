2022년도 1학기 딥러닝 기초 수업 때 진행한 기말 프로젝트

# 손글씨 인식 인공신경망 구현
CNN 신경망을 이용한 손글씨 인식 인공지능 훈련시키기


## 최종적으로 선정한 신경망 모델
<img width="127" alt="그림1" src="https://user-images.githubusercontent.com/71822139/195761511-3474908e-cb70-4b29-9466-c7d6bc5b8304.png">


### Input
원본 데이터를 불러오거나 시뮬레이션을 통해 데이터를 생성한다.
데이터로부터 훈련셋, 검증셋, 시험셋을 생성한다.
이 때 딥러닝 모델의 학습 및 평가를 할 수 있도록 포맷 변환을 한다.
### Convolution
모델 구성하기
시퀀스 모델을 생성한 뒤 필요한 레이어를 추가하여 구성한다.
좀 더 복잡한 모델이 필요할 때는 케라스 함수 API를 사용한다. 또한 모델 학습과정을 설정한다.학습하기 전에 학습에 대한 설정을 수행한다. 그리고 손실 함수 및 최적화 방법을 정의한다.
케라스 문법으로는 compile() 함수를 사용했다.
### Dropout
특정한 Feature만 과도하게 집중하여 학습함으로써 발생할 수 있는 과대적합(overfitting)을 방지하기 위해 사용했다.
### MaxPooling
Convolution layer에서 filter을 이용해 이미지의 feature map을 계산하였고 그 계산 결과를 pooling을 통해 다운 샘플링을 진행한다. 다운 샘플링을 하는 이유는 input size를 줄이고 overfitting을 조절하고 특징을 더욱 잘 뽑아내기 위함이다.
그 다음 합성곱 신경망과 풀링 계층 후 Dense층을 통해 Input과 Output을 모두 연결해주었다. 그 다음 과적합을 방지하기 위해 Dropout 계층을 적용해주었고 마지막으로 Dense층으로 출력하였다.

## 성능평가
### 사용한 자원(메모리 사용량)

- Accuracy_97%.h5 모델 사용

<img width="358" alt="스크린샷 2022-10-14 오후 1 51 53" src="https://user-images.githubusercontent.com/71822139/195765075-fddd5062-2d32-4c1e-b0a0-1e4d20c4eb38.png">

- 사용한 파라미터 개수 : Total params – Non-trainable params = 64,567

### 학습 성능, 인식 성능
- Matplotlib를 이용한 학습결과 그래프 확인
<img width="535" alt="스크린샷 2022-10-14 오후 1 52 06" src="https://user-images.githubusercontent.com/71822139/195765093-8ed3f3fa-b8f9-46d9-895d-ce6469901896.png">

## 결과
교수님이 주신 429개의 테스트 셋 적용 결과 (test_data/testdata1D.pkl)
   - 손실률 : 0.068690694
   - 정확도 : 0.9790209531
   - 맞추지 못한 글씨 이미지 16개 랜덤으로 출력한 결과
   <img width="516" alt="스크린샷 2022-10-14 오후 1 54 35" src="https://user-images.githubusercontent.com/71822139/195765303-086dcaa7-1992-49e2-8766-dfdaee3cd77d.png">

Final 테스트셋 적용 결과
   1) 6명이 쓴 1343개 (DataSet1)
   - 손실률 : 0.2278
   - 정확도 : 0.9210

   - 맞추지 못한 글씨 이미지 16개 랜덤으로 출력한 결과
   <img width="535" alt="스크린샷 2022-10-14 오후 1 57 00" src="https://user-images.githubusercontent.com/71822139/195765549-8561d332-cb65-4d99-b5f7-d2982b5dea21.png">

   
   2) 1명이 쓴 975개 (DataSet2)
- 손실률 : 0.2803
- 정확도 : 0.9005
- 맞추지 못한 글씨 이미지 16개 랜덤으로 출력한 결과
<img width="519" alt="스크린샷 2022-10-14 오후 1 57 08" src="https://user-images.githubusercontent.com/71822139/195765568-9f0638d8-b63e-44a2-96b5-4da841d981cb.png">

3) MNIST 임의 데이터 2000개
- 손실률 : 0.0074
- 정확도 : 0.9969
- 맞추지 못한 글씨 이미지 16개 랜덤으로 출력한 결과 (겹치는 이미지 존재)
<img width="523" alt="스크린샷 2022-10-14 오후 2 00 38" src="https://user-images.githubusercontent.com/71822139/195765983-abe23523-f4d6-4fca-98cc-6cf63cab6342.png">


## 결과 피드백과 느낀점
### 유다영

딥러닝 프로젝트를 한다고 수업시간에 들었을 때 정말 막막했다. 하지만 팀이 꾸려지고 팀원 들과 함께 이야기를 하면서 역할을 나누고 프로젝트가 진행되면서 수업시간에는 미처 배우 지 못한 협력하는 태도와 딥러닝 프레임워크 등을 익힐 수 있었다. 나 혼자라면 해내지 못했 을 텐데 팀원들과 함께해서 마지막까지 해낼 수 있었다. 이번 딥러닝 프로젝트는 내게 새로 운 경험이었고 머신러닝, 인공신경망에 대해 더욱 이해를 할 수 있었던 정말 좋은 기회였다. 테스트 후 모델이 인식 못한 데이터를 화면에 띄워본 결과 숫자 사이가 지워진 부분을 훈련 데이터에 넣지 않았기에 이부분이 정확도가 떨어진 이유라고 생각한다.

### 이수진

FinalTest 결과가 이렇게 나온 이유는 다양한 훈련데이터셋 부족이라고 생각한다.
숫자 중 끊어진 숫자, 흐릿한 숫자, 굵기가 다양한 숫자 등에 대한 훈련 데이터셋 확보가 부 족했다고 생각한다. 훈련 데이터셋의 양도 중요하지만 다양한 훈련 데이터셋 확보 또한 중요 하다는 것을 느꼈다. 또한 다른 팀들의 결과를 보면서 Parameter의 개수나 배치크기 등이 무 조건 많다고 좋은 것이 아니라는 것을 다시 한번 느꼈다. 모델을 구성하면서 여러 어려움도 있었지만 이번 프로젝트로 인하여 딥러닝에 대한 공부를 스스로하고 팀들과 의견을 주고 받 으면서 많은 것을 배웠고 의미있던 프로젝트라고 생각한다.

### 박해인

인공지능에 대해서 개념만 배웠었지만 이번 팀플을 통하여 keras를 통해 직접 모델을 만들어 볼 수 있어서 좋았다. 앞으로도 다양한 프로젝트에 딥러닝을 응용해볼 수 있겠다라는 생각이 들었다. 또, 다른팀들의 발표를 통하여 정확도를 높이기 위한 여러가지 방법들을 공유할 수 있었고 생각보단 정확도 측면에서는 아쉬웠지만 직접 모델을 짜다보니 합성곱신경망의 정확 한 역할이나, 최적화를 위한 여러가지 지표들의 역할을 보다 정확히 파악할 수 있었던 시간 이 되었던 것 같다. 팀플 하면서 팀원들 또한 너무 잘 참여해줘서, 즐거웠던 팀플이였던 것 같다.


## Contributor
| 박해인 [Github](https://github.com/femmefatalehaein) | 유다영 [Github](https://github.com/allzeroyou) | 이수진 [Github](https://github.com/Soojin-Lee-01) |